<Page
    x:Class="DDSStudyOS.App.Pages.BrowserPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:Microsoft.UI.Xaml.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    NavigationCacheMode="Required"
    mc:Ignorable="d">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" x:Name="TopBarRow" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Top Bar -->
        <Grid Grid.Row="0" Padding="12,8" ColumnSpacing="12" Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/> <!-- Nav Buttons -->
                <ColumnDefinition Width="*"/>    <!-- URL Box -->
                <ColumnDefinition Width="Auto"/> <!-- Action Buttons -->
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
                    <Image Source="ms-appx:///Assets/DDSStudyOS-Icon-Source.png" Width="20" Height="20"/>
                    <TextBlock Text="DDS StudyOS Browser" FontWeight="SemiBold" VerticalAlignment="Center" />
                </StackPanel>
                <AppBarSeparator />
                <Button x:Name="HomeBtn" Content="&#xE80F;" FontFamily="Segoe MDL2 Assets" Click="Home_Click" ToolTipService.ToolTip="Pagina inicial DDS"/>
                <Button x:Name="BackBtn" Content="&#xE72B;" FontFamily="Segoe MDL2 Assets" Click="Back_Click" ToolTipService.ToolTip="Voltar"/>
                <Button x:Name="ForwardBtn" Content="&#xE72A;" FontFamily="Segoe MDL2 Assets" Click="Forward_Click" ToolTipService.ToolTip="Avançar"/>
                <Button x:Name="ReloadBtn" Content="&#xE72C;" FontFamily="Segoe MDL2 Assets" Click="Reload_Click" ToolTipService.ToolTip="Recarregar"/>
            </StackPanel>

            <TextBox Grid.Column="1" x:Name="AddressBox" PlaceholderText="Pesquisar na web ou digitar URL..." KeyDown="AddressBox_KeyDown" Margin="0,0,0,0"/>

            <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8">
                <Button x:Name="GoBtn" Content="Ir" Click="Go_Click" Style="{StaticResource AccentButtonStyle}" />
                <Button x:Name="FavoritesBtn" Content="&#xE734;" FontFamily="Segoe MDL2 Assets" Click="Favorites_Click" ToolTipService.ToolTip="Favoritos (Cursos marcados)"/>
                <Button x:Name="CoursesBtn" Content="&#xE8B7;" FontFamily="Segoe MDL2 Assets" Click="Courses_Click" ToolTipService.ToolTip="Todos os cursos"/>
                <Button x:Name="VaultFillBtn" Content="&#xE13D;" FontFamily="Segoe MDL2 Assets" Click="VaultFill_Click" ToolTipService.ToolTip="Preencher login pelo Cofre DDS"/>
                <AppBarSeparator />
                <ToggleButton x:Name="NotesToggle" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" Click="NotesToggle_Click" ToolTipService.ToolTip="Smart Notes (Anotações)" IsChecked="False"/>
                <ToggleButton x:Name="CinemaModeToggle" Content="&#xE793;" FontFamily="Segoe MDL2 Assets" Click="CinemaMode_Click" ToolTipService.ToolTip="Modo Cinema (Foco Total)"/>
            </StackPanel>
        </Grid>

        <!-- Main Content Area (Split View) -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- Browser -->
            <controls:WebView2 x:Name="Web" Grid.Column="0" Source="about:blank" />

            <!-- Smart Notes Panel -->
            <Grid x:Name="NotesPanel" Grid.Column="1" Width="350" Visibility="Collapsed" BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}" BorderThickness="1,0,0,0" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="Smart Notes" Style="{StaticResource SubtitleTextBlockStyle}" Margin="12,12,12,8"/>
                
                <TextBox Grid.Row="1" x:Name="NotesBox" 
                         AcceptsReturn="True" TextWrapping="Wrap" 
                         PlaceholderText="Faça anotações da aula aqui..." 
                         Margin="12,0,12,12" 
                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                         FontFamily="Consolas" />
                
                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8" Margin="12,0,12,12">
                    <TextBlock x:Name="SaveStatusText" Text="Salvo" FontSize="12" Foreground="Gray" VerticalAlignment="Center" Visibility="Collapsed"/>
                    <Button Content="Salvar Agora" Click="SaveNotes_Click"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</Page>
