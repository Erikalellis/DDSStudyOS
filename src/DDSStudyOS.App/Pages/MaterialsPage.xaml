<Page
    x:Class="DDSStudyOS.App.Pages.MaterialsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid Padding="16" RowDefinitions="Auto,*,Auto">
        <TextBlock Text="Materiais &amp; Certificados"
                   FontSize="24"
                   FontWeight="SemiBold" />

        <Grid Grid.Row="1" Margin="0,12,0,0" ColumnDefinitions="1.05*,0.95*" ColumnSpacing="16">
            <Border Grid.Column="0"
                    Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}"
                    BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="14">
                <ScrollViewer VerticalScrollBarVisibility="Auto" VerticalScrollMode="Auto">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Cadastro" FontWeight="SemiBold" Opacity="0.9" />
                        <ComboBox x:Name="CourseCombo" Header="Vincular ao curso (opcional)" />
                        <TextBox x:Name="FileNameBox" Header="Nome" PlaceholderText="Ex: certificado_csharp.pdf" />

                        <Grid ColumnDefinitions="*,Auto" ColumnSpacing="8">
                            <TextBox Grid.Column="0"
                                     x:Name="FilePathBox"
                                     Header="Caminho do arquivo ou URL"
                                     PlaceholderText="C:\...\arquivo.pdf ou https://..." />
                            <Button Grid.Column="1"
                                    Content="Procurar"
                                    VerticalAlignment="Bottom"
                                    Click="Browse_Click" />
                        </Grid>

                        <TextBox x:Name="FileTypeBox" Header="Tipo (opcional)" PlaceholderText="PDF / Certificado / Vídeo / Docs ..." />
                        <CheckBox x:Name="ManagedCopyCheck" Content="Copiar arquivo para a biblioteca interna do DDS StudyOS" />

                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <Button Content="Salvar (novo)" Click="Create_Click" Style="{StaticResource AccentButtonStyle}" />
                            <Button Content="Atualizar selecionado" Click="Update_Click" />
                            <Button Content="Excluir selecionado" Click="Delete_Click" />
                            <Button Content="Abrir arquivo" Click="Open_Click" />
                            <Button Content="Limpar" Click="Clear_Click" />
                        </StackPanel>

                        <TextBlock x:Name="MsgText"
                                   Text=""
                                   TextWrapping="WrapWholeWords"
                                   Foreground="{ThemeResource SystemControlForegroundAccentBrush}"
                                   FontWeight="SemiBold" />
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <Border Grid.Column="1"
                    Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}"
                    BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="14">
                <StackPanel Spacing="10">
                    <TextBlock Text="Cadastrados" FontWeight="SemiBold" Opacity="0.9" />
                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="8" RowSpacing="8">
                        <ComboBox x:Name="FilterCourseCombo" Header="Curso" />
                        <ComboBox x:Name="FilterTypeCombo" Grid.Column="1" Header="Tipo" />
                        <CalendarDatePicker x:Name="FilterDateFromPicker"
                                            Grid.Row="1"
                                            Header="Data inicial"
                                            PlaceholderText="dd/mm/aaaa" />
                        <CalendarDatePicker x:Name="FilterDateToPicker"
                                            Grid.Row="1"
                                            Grid.Column="1"
                                            Header="Data final"
                                            PlaceholderText="dd/mm/aaaa" />
                        <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" Spacing="8">
                            <Button Content="Aplicar filtros" Click="ApplyFilters_Click" />
                            <Button Content="Limpar filtros" Click="ClearFilters_Click" />
                        </StackPanel>
                    </Grid>
                    <ListView x:Name="MaterialsList"
                              SelectionChanged="MaterialsList_SelectionChanged"
                              Height="330"
                              BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}"
                              BorderThickness="1" />
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button Content="Recarregar" Click="Reload_Click" />
                        <Button Content="Usar curso do cadastro" Click="FilterByCourse_Click" />
                        <Button Content="Ver todos" Click="ShowAll_Click" />
                        <Button Content="Abrir pasta" Click="OpenFolder_Click" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>

        <InfoBar Grid.Row="2"
                 Margin="0,12,0,0"
                 Title="Nota"
                 Message="Você pode registrar caminho local, URL ou salvar uma cópia gerenciada no DDS StudyOS. Em conteúdos com bloqueio da plataforma, use o link da aula/material."
                 IsOpen="True"
                 Severity="Informational" />
    </Grid>
</Page>
