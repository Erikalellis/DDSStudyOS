<Window
    x:Class="DDSStudyOS.App.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DDSStudyOS.App"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid x:Name="RootGrid" Loaded="RootGrid_Loaded">
        <Grid x:Name="ShellRoot">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0"
                    Background="#FFF7F7FA"
                    BorderBrush="#22000000"
                    BorderThickness="0,0,1,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <ListView x:Name="NavView"
                              Grid.Row="0"
                              Loaded="NavView_Loaded"
                              Margin="12,16,12,12"
                              SelectionChanged="NavView_SelectionChanged"
                              SelectionMode="Single"
                              HorizontalAlignment="Stretch"
                              HorizontalContentAlignment="Stretch"
                              ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                              ScrollViewer.HorizontalScrollMode="Disabled">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="MinHeight" Value="48" />
                                <Setter Property="Margin" Value="0,0,0,6" />
                                <Setter Property="Padding" Value="0" />
                            </Style>
                        </ListView.ItemContainerStyle>

                        <ListViewItem x:Name="NavItemDashboard" Tag="dashboard">
                            <StackPanel Orientation="Horizontal" Spacing="12" Padding="12,10">
                                <SymbolIcon Symbol="Home" />
                                <TextBlock Text="Dashboard" VerticalAlignment="Center" />
                            </StackPanel>
                        </ListViewItem>
                        <ListViewItem x:Name="NavItemCourses" Tag="courses">
                            <StackPanel Orientation="Horizontal" Spacing="12" Padding="12,10">
                                <SymbolIcon Symbol="Library" />
                                <TextBlock Text="Cursos" VerticalAlignment="Center" />
                            </StackPanel>
                        </ListViewItem>
                        <ListViewItem x:Name="NavItemMaterials" Tag="materials">
                            <StackPanel Orientation="Horizontal" Spacing="12" Padding="12,10">
                                <SymbolIcon Symbol="Folder" />
                                <TextBlock Text="Materiais &amp; Certificados" VerticalAlignment="Center" />
                            </StackPanel>
                        </ListViewItem>
                        <ListViewItem x:Name="NavItemAgenda" Tag="agenda">
                            <StackPanel Orientation="Horizontal" Spacing="12" Padding="12,10">
                                <SymbolIcon Symbol="Calendar" />
                                <TextBlock Text="Agenda" VerticalAlignment="Center" />
                            </StackPanel>
                        </ListViewItem>
                        <ListViewItem x:Name="NavItemBrowser" Tag="browser">
                            <StackPanel Orientation="Horizontal" Spacing="12" Padding="12,10">
                                <SymbolIcon Symbol="Globe" />
                                <TextBlock Text="Navegador" VerticalAlignment="Center" />
                            </StackPanel>
                        </ListViewItem>
                        <ListViewItem x:Name="NavItemSettings" Tag="settings">
                            <StackPanel Orientation="Horizontal" Spacing="12" Padding="12,10">
                                <SymbolIcon Symbol="Setting" />
                                <TextBlock Text="ConfiguraÃ§Ãµes" VerticalAlignment="Center" />
                            </StackPanel>
                        </ListViewItem>
                        <ListViewItem x:Name="NavItemDev" Tag="dev">
                            <StackPanel Orientation="Horizontal" Spacing="12" Padding="12,10">
                                <SymbolIcon Symbol="Contact" />
                                <TextBlock Text="Desenvolvimento" VerticalAlignment="Center" />
                            </StackPanel>
                        </ListViewItem>
                    </ListView>

                    <Border Grid.Row="1" BorderBrush="#33000000" BorderThickness="0,1,0,0" Padding="12">
                        <StackPanel Spacing="8">
                            <Border x:Name="ProfileCardBorder" Background="#221D4ED8" CornerRadius="8" Padding="10">
                                <StackPanel Spacing="2">
                                    <TextBlock Text="Perfil ativo" FontSize="11" Opacity="0.8" />
                                    <TextBlock x:Name="UserGreetingText" Text="OlÃ¡, estudante!" FontWeight="SemiBold" FontSize="14" />
                                    <TextBlock x:Name="UserSubtitleText" Text="Configure seu cadastro inicial." FontSize="11" Opacity="0.8" />
                                </StackPanel>
                            </Border>

                            <TextBlock Text="Pomodoro Focus" FontWeight="SemiBold" FontSize="12" Opacity="0.8"/>
                            <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Center">
                                <TextBlock x:Name="PomoTimerText" Text="25:00" FontSize="20" FontWeight="Bold" VerticalAlignment="Center" FontFamily="Consolas"/>
                                <Button x:Name="PomoActionBtn" Content="&#xE768;" FontFamily="Segoe MDL2 Assets" Click="PomoAction_Click" ToolTipService.ToolTip="Iniciar/Pausar"/>
                                <Button x:Name="PomoResetBtn" Content="&#xE74D;" FontFamily="Segoe MDL2 Assets" Click="PomoReset_Click" ToolTipService.ToolTip="Parar"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                <Button Content="Foco" Click="PomoWork_Click" FontSize="11"/>
                                <Button Content="Pausa" Click="PomoBreak_Click" FontSize="11"/>
                            </StackPanel>
                            <Button Content="Config. Pomodoro" Click="PomoSettings_Click" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <Frame Grid.Column="1" x:Name="ContentFrame" />
        </Grid>

        <!-- Onboarding wizard (first run). -->
        <Grid x:Name="OnboardingOverlay" IsHitTestVisible="True" Visibility="Collapsed" RequestedTheme="Dark">
            <Grid.Background>
                <ImageBrush ImageSource="ms-appx:///Assets/SplashBackdrop.png" Stretch="UniformToFill" />
            </Grid.Background>
            <Grid.Resources>
                <SolidColorBrush x:Key="OnboardingInputBackgroundBrush" Color="#FF121B31" />
                <SolidColorBrush x:Key="OnboardingInputBorderBrush" Color="#6CF5F7FF" />
                <SolidColorBrush x:Key="OnboardingInputForegroundBrush" Color="#FFF7F9FF" />
                <SolidColorBrush x:Key="OnboardingChipBackgroundBrush" Color="#1D2236" />
                <SolidColorBrush x:Key="OnboardingChipSelectedBrush" Color="#7C3AED" />
                <SolidColorBrush x:Key="OnboardingChipBorderBrush" Color="#4B5563" />

                <Style TargetType="TextBox">
                    <Setter Property="Foreground" Value="{StaticResource OnboardingInputForegroundBrush}" />
                    <Setter Property="Background" Value="{StaticResource OnboardingInputBackgroundBrush}" />
                    <Setter Property="BorderBrush" Value="{StaticResource OnboardingInputBorderBrush}" />
                </Style>

                <Style TargetType="TimePicker">
                    <Setter Property="Foreground" Value="{StaticResource OnboardingInputForegroundBrush}" />
                    <Setter Property="Background" Value="{StaticResource OnboardingInputBackgroundBrush}" />
                    <Setter Property="BorderBrush" Value="{StaticResource OnboardingInputBorderBrush}" />
                </Style>

                <Style x:Key="OnboardingChoiceButtonStyle" TargetType="Button">
                    <Setter Property="MinHeight" Value="44" />
                    <Setter Property="CornerRadius" Value="22" />
                    <Setter Property="Background" Value="{StaticResource OnboardingChipBackgroundBrush}" />
                    <Setter Property="Foreground" Value="White" />
                    <Setter Property="BorderBrush" Value="{StaticResource OnboardingChipBorderBrush}" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="Padding" Value="14,8" />
                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                </Style>
            </Grid.Resources>
            <Rectangle Fill="#D9060812" />

            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  MaxWidth="540"
                  Width="540"
                  Margin="24">
                <Border Background="#E60A1228"
                        BorderBrush="#66C6D8FF"
                        BorderThickness="1"
                        CornerRadius="18"
                        Padding="28">
                    <StackPanel Spacing="20">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="14">
                                <Border CornerRadius="999" Background="#22FFFFFF" Padding="10" VerticalAlignment="Top">
                                    <Image Source="ms-appx:///Assets/SplashBackground.png"
                                           Width="52"
                                           Height="52"
                                           Stretch="UniformToFill" />
                                </Border>

                                <StackPanel Spacing="4">
                                    <TextBlock x:Name="OnboardingStepCounterText"
                                               Text="Passo 1 de 4"
                                               Foreground="#BFE4E8FF"
                                               FontSize="12"
                                               FontWeight="SemiBold" />
                                    <ProgressBar x:Name="OnboardingProgressBar"
                                                 Width="360"
                                                 Height="8"
                                                 Foreground="#FF7B61FF" />
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Spacing="4">
                                <TextBlock x:Name="OnboardingHeadlineText"
                                           Text="Bem-vinda(o) ao DDS StudyOS"
                                           Foreground="White"
                                           FontSize="24"
                                           FontWeight="SemiBold" />
                                <TextBlock x:Name="OnboardingSubheadlineText"
                                           Text="Crie seu perfil para comeÃ§ar."
                                           Foreground="#DDE9F2FF"
                                           FontSize="13"
                                           TextWrapping="WrapWholeWords" />
                            </StackPanel>
                        </StackPanel>

                        <Grid>
                            <StackPanel x:Name="OnboardingStep1Panel" Spacing="12">
                                <TextBox x:Name="OnboardingFullNameBox"
                                         Header="Nome completo *"
                                         PlaceholderText="Ex.: Erika Lellis"
                                         TextChanged="OnboardingFieldChanged" />
                                <TextBox x:Name="OnboardingPreferredNameBox"
                                         Header="Como prefere ser chamada *"
                                         PlaceholderText="Ex.: Erika"
                                         TextChanged="OnboardingFieldChanged" />
                                <TextBox x:Name="OnboardingEmailBox"
                                         Header="E-mail *"
                                         PlaceholderText="exemplo@dominio.com"
                                         TextChanged="OnboardingFieldChanged" />
                            </StackPanel>

                            <StackPanel x:Name="OnboardingStep2Panel" Spacing="16" Visibility="Collapsed">
                                <TextBlock Text="Escolha sua Ã¡rea principal."
                                           Foreground="#E6FFFFFF"
                                           FontSize="13" />
                                <Grid RowSpacing="12" ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <Button x:Name="AreaDevButton" Grid.Row="0" Grid.Column="0" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="ðŸ’» Desenvolvimento" Tag="Desenvolvimento" Click="OnboardingArea_Click" />
                                    <Button x:Name="AreaDataButton" Grid.Row="0" Grid.Column="1" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="ðŸ“Š Dados" Tag="Dados" Click="OnboardingArea_Click" />
                                    <Button x:Name="AreaMarketingButton" Grid.Row="1" Grid.Column="0" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="ðŸ“ˆ Marketing" Tag="Marketing" Click="OnboardingArea_Click" />
                                    <Button x:Name="AreaDesignButton" Grid.Row="1" Grid.Column="1" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="ðŸŽ¨ Design" Tag="Design" Click="OnboardingArea_Click" />
                                    <Button x:Name="AreaExamButton" Grid.Row="2" Grid.Column="0" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="ðŸ“š Concurso" Tag="Concurso" Click="OnboardingArea_Click" />
                                    <Button x:Name="AreaLanguageButton" Grid.Row="2" Grid.Column="1" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="âœï¸ Idiomas" Tag="Idiomas" Click="OnboardingArea_Click" />
                                    <Button x:Name="AreaOtherButton" Grid.Row="3" Grid.ColumnSpan="2" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="âž• Outros" Tag="Outros" Click="OnboardingArea_Click" />
                                </Grid>

                                <TextBox x:Name="OnboardingCustomAreaBox"
                                         Header="Descreva a Ã¡rea (quando selecionar Outros)"
                                         PlaceholderText="Ex.: MÃºsica, FinanÃ§as, Direito..."
                                         TextChanged="OnboardingFieldChanged"
                                         Visibility="Collapsed" />

                                <StackPanel Spacing="10">
                                    <TextBlock Text="NÃ­vel"
                                               Foreground="#E6FFFFFF"
                                               FontSize="13" />
                                    <Grid ColumnSpacing="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button x:Name="LevelBeginnerButton" Grid.Column="0" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="Iniciante" Tag="Iniciante" Click="OnboardingLevel_Click" />
                                        <Button x:Name="LevelIntermediateButton" Grid.Column="1" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="IntermediÃ¡rio" Tag="IntermediÃ¡rio" Click="OnboardingLevel_Click" />
                                        <Button x:Name="LevelAdvancedButton" Grid.Column="2" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="AvanÃ§ado" Tag="AvanÃ§ado" Click="OnboardingLevel_Click" />
                                    </Grid>
                                </StackPanel>
                            </StackPanel>

                            <StackPanel x:Name="OnboardingStep3Panel" Spacing="18" Visibility="Collapsed">
                                <StackPanel Spacing="6">
                                    <TextBlock Text="Meta diÃ¡ria"
                                               Foreground="#E6FFFFFF"
                                               FontSize="13" />
                                    <TextBlock x:Name="OnboardingGoalValueText"
                                               Text="60 minutos"
                                               Foreground="White"
                                               FontSize="20"
                                               FontWeight="SemiBold" />
                                    <Slider x:Name="OnboardingDailyGoalSlider"
                                            ValueChanged="OnboardingGoalSlider_ValueChanged" />
                                </StackPanel>

                                <StackPanel Spacing="10">
                                    <TextBlock Text="Turno preferido"
                                               Foreground="#E6FFFFFF"
                                               FontSize="13" />
                                    <Grid ColumnSpacing="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button x:Name="ShiftMorningButton" Grid.Column="0" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="ManhÃ£" Tag="ManhÃ£" Click="OnboardingShift_Click" />
                                        <Button x:Name="ShiftAfternoonButton" Grid.Column="1" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="Tarde" Tag="Tarde" Click="OnboardingShift_Click" />
                                        <Button x:Name="ShiftNightButton" Grid.Column="2" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="Noite" Tag="Noite" Click="OnboardingShift_Click" />
                                        <Button x:Name="ShiftFlexibleButton" Grid.Column="3" Style="{StaticResource OnboardingChoiceButtonStyle}" Content="FlexÃ­vel" Tag="FlexÃ­vel" Click="OnboardingShift_Click" />
                                    </Grid>
                                </StackPanel>

                                <ToggleSwitch x:Name="OnboardingRemindersToggle"
                                              Header="Ativar lembretes diÃ¡rios"
                                              Toggled="OnboardingRemindersToggle_Toggled" />

                                <StackPanel x:Name="OnboardingReminderTimePanel" Spacing="8">
                                    <TextBlock Text="HorÃ¡rio preferido"
                                               Foreground="#E6FFFFFF"
                                               FontSize="13" />
                                    <TimePicker x:Name="OnboardingReminderTimePicker" />
                                </StackPanel>
                            </StackPanel>

                            <StackPanel x:Name="OnboardingStep4Panel" Spacing="16" Visibility="Collapsed">
                                <TextBlock Text="Seu plano inicial foi criado com base no seu perfil."
                                           Foreground="#E6FFFFFF"
                                           FontSize="13"
                                           TextWrapping="WrapWholeWords" />
                                <Border Background="#221D4ED8"
                                        CornerRadius="14"
                                        Padding="18">
                                    <StackPanel Spacing="10">
                                        <TextBlock x:Name="OnboardingSummaryNameText" Text="Nome: -" Foreground="White" FontSize="15" FontWeight="SemiBold" />
                                        <TextBlock x:Name="OnboardingSummaryAreaText" Text="Ãrea: -" Foreground="#E6FFFFFF" />
                                        <TextBlock x:Name="OnboardingSummaryLevelText" Text="NÃ­vel: -" Foreground="#E6FFFFFF" />
                                        <TextBlock x:Name="OnboardingSummaryGoalText" Text="Meta diÃ¡ria: -" Foreground="#E6FFFFFF" />
                                        <TextBlock x:Name="OnboardingSummaryShiftText" Text="Turno: -" Foreground="#E6FFFFFF" />
                                    </StackPanel>
                                </Border>
                                <TextBlock Text="VocÃª poderÃ¡ editar tudo depois em ConfiguraÃ§Ãµes."
                                           Foreground="#BFE4E8FF"
                                           FontSize="12"
                                           TextWrapping="WrapWholeWords" />
                            </StackPanel>
                        </Grid>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Spacing="12">
                            <HyperlinkButton x:Name="OnboardingSkipButton"
                                             Content="Pular por agora"
                                             Click="OnboardingSkip_Click" />
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
                                <Button x:Name="OnboardingBackButton"
                                        Content="â† Voltar"
                                        Click="OnboardingBack_Click" />
                                <Button x:Name="OnboardingNextButton"
                                        Content="Continuar â†’"
                                        Click="OnboardingNext_Click" />
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>

        <!-- Splash overlay (first launch + initialization). Hidden after bootstrap. -->
        <Grid x:Name="SplashOverlay" IsHitTestVisible="True" Visibility="Visible">
            <Grid.Background>
                <ImageBrush ImageSource="ms-appx:///Assets/SplashBackdrop.png" Stretch="UniformToFill" />
            </Grid.Background>
            <Rectangle x:Name="SplashTintOverlay" Fill="#C2050612" />

            <StackPanel x:Name="SplashContent"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Bottom"
                        Margin="0,0,0,72"
                        Spacing="10">
                <StackPanel HorizontalAlignment="Center" Spacing="4">
                    <Border x:Name="SplashChannelBadge"
                            HorizontalAlignment="Center"
                            CornerRadius="999"
                            Padding="12,4"
                            Background="#334AC277"
                            BorderBrush="#998CE8B3"
                            BorderThickness="1">
                        <TextBlock x:Name="SplashChannelBadgeText"
                                   Text="STABLE v0.0.0"
                                   Foreground="#FFE3FFEF"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   HorizontalAlignment="Center" />
                    </Border>
                    <TextBlock x:Name="SplashTitleText"
                               Text="Carregando DDS StudyOS"
                               Foreground="White"
                               FontSize="30"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center" />
                    <TextBlock x:Name="SplashVersionText"
                               Text="v0.0.0"
                               Foreground="#99FFFFFF"
                               FontSize="11"
                               HorizontalAlignment="Center" />
                </StackPanel>

                <StackPanel Width="560" Spacing="10">
                    <ProgressBar x:Name="SplashProgressBar"
                                 Minimum="0"
                                 Maximum="100"
                                 Value="0"
                                 Height="8"
                                 Foreground="#FF7B61FF" />
                    <TextBlock x:Name="SplashStatusText"
                               Text="Iniciando..."
                               Foreground="#CCFFFFFF"
                               FontSize="13"
                               TextAlignment="Center"
                               TextWrapping="WrapWholeWords" />
                </StackPanel>
            </StackPanel>
        </Grid>

        <!-- Guided tour (first run). -->
        <TeachingTip x:Name="GuidedTourTip"
                     IsOpen="False"
                     IsLightDismissEnabled="False"
                     RequestedTheme="Dark"
                     Background="#FF111827"
                     BorderBrush="#FF365080"
                     BorderThickness="1"
                     MinWidth="320"
                     MaxWidth="440"
                     PreferredPlacement="Auto"
                     ActionButtonClick="GuidedTourTip_ActionButtonClick"
                     CloseButtonClick="GuidedTourTip_CloseButtonClick">
            <StackPanel Spacing="6" MaxWidth="420">
                <TextBlock x:Name="GuidedTourTitleText"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Foreground="#FFF6F7FB"
                           TextWrapping="WrapWholeWords" />
                <TextBlock x:Name="GuidedTourSubtitleText"
                           FontSize="13"
                           Foreground="#E6FFFFFF"
                           TextWrapping="WrapWholeWords" />
            </StackPanel>
        </TeachingTip>
    </Grid>
</Window>
